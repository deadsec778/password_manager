<!DOCTYPE html>
<html>
<head>
    <title>{{ title or "Password Manager" }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f5f7fa;
        }
        .navbar-brand {
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        .nav-link.active {
            font-weight: bold;
        }
        .content-container {
            margin-top: 30px;
        }
    </style>
</head>

<body>

{# ----------------------------- #}
{# TOP NAVBAR (GLOBAL) #}
{# ----------------------------- #}

<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
    <div class="container-fluid">

        <a class="navbar-brand" href="{{ url_for('dashboard') }}">
            üîê Password Manager
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav" aria-controls="navbarNav"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">

            <ul class="navbar-nav me-auto">

                <li class="nav-item">
                    <a class="nav-link {% if request.path.startswith('/dashboard') %}active{% endif %}"
                       href="{{ url_for('dashboard') }}">Dashboard</a>
                </li>

                {# SHOW TRASH ONLY FOR ADMINS #}
                {% if session.get("role") == "admin" %}
                <li class="nav-item">
                    <a class="nav-link {% if request.path.startswith('/trash') %}active{% endif %}"
                       href="{{ url_for('trash') }}">Trash</a>
                </li>
                {% endif %}

                {# ADMIN PANEL (admin only) #}
                {% if session.get("role") == "admin" %}
                <li class="nav-item">
                    <a class="nav-link {% if request.path.startswith('/admin') %}active{% endif %}"
                       href="{{ url_for('admin_users') }}">Admin Panel</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{{ url_for('admin_add_user') }}">Add User</a>
                </li>
                {% endif %}
                {% if session.role == "admin" %}
                <li class="nav-item">
                    <a class="nav-link {% if request.path.startswith('/admin') %}active{% endif %}"
                    href="{{ url_for('import_passwords_page') }}">Import Passwords</a>
                </li>
                {% endif %}

            </ul>

            <ul class="navbar-nav ms-auto">
                {% if session.get("username") %}
                <li class="nav-item">
                    <span class="nav-link text-info">
                         {{ session.username }} ({{ session.role }})
                    </span>
                </li>
                <li class="nav-item">
                    <a class="btn btn-sm btn-danger" href="{{ url_for('logout') }}">Logout</a>
                </li>
                {% endif %}
            </ul>

        </div>
    </div>
</nav>


<div class="container content-container">
    {# Flash messages #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, msg in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show">
              {{ msg }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</div>






<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
function togglePassword(fieldId, eyeId) {
    const field = document.getElementById(fieldId);
    const eye = document.getElementById(eyeId);

    if (field.type === "password") {
        field.type = "text";
        eye.innerHTML = "üôà";  // hide icon
    } else {
        field.type = "password";
        eye.innerHTML = "üëÅÔ∏è"; // show icon
    }
}
</script>
<script>
function togglePasswordRow(pid) {
    const mask = document.getElementById("mask_" + pid);
    const real = document.getElementById("real_" + pid);

    if (real.style.display === "none") {
        real.style.display = "inline";
        mask.style.display = "none";
    } else {
        real.style.display = "none";
        mask.style.display = "inline";
    }
}
</script>
</body>
</html>
